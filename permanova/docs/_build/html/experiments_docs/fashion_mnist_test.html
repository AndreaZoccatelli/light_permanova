
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PERMANOVA test on images &#8212; Light PERMANOVA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'experiments_docs/fashion_mnist_test';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="PERMANOVA test on tabular data" href="test_tabular_numpy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Light PERMANOVA  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../modules.html">Light PERMANOVA</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/introduction.html">Overview</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numpy_implementation/numpy.html">permanova_np module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../numpy_implementation/permanova.html">PERMANOVA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numpy_implementation/lightpermanova_np.html">LightPERMANOVA</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../pytorch_implementation/pytorch.html">permanova_torch module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../pytorch_implementation/lightpermanova_torch.html">LightPERMANOVA</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="experiments_docs.html">Experiments</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="exp_utils.html">exp_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="test_tabular_numpy.html">PERMANOVA test on tabular data</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">PERMANOVA test on images</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/experiments_docs/fashion_mnist_test.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PERMANOVA test on images</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Dataset">Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Model-Training-+-Save">Model Training + Save</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Load-Trained-Model">Load Trained Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Comparison-with-PERMANOVA">Comparison with PERMANOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Adversarial-Attack---Training">Adversarial Attack - Training</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Adversarial-Attack---Load-adv.-dataset">Adversarial Attack - Load adv. dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Comparison with PERMANOVA</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="PERMANOVA-test-on-images">
<h1>PERMANOVA test on images<a class="headerlink" href="#PERMANOVA-test-on-images" title="Link to this heading">#</a></h1>
<p><strong>Dataset</strong>: <a class="reference external" href="https://github.com/zalandoresearch/fashion-mnist">Fashion MNIST dataset</a></p>
<p><strong>Model</strong>: <a class="reference external" href="https://arxiv.org/abs/1512.03385">ResNet18</a></p>
<p><strong>Colab Runtime</strong>: Nvidia T4</p>
<p><strong>Steps</strong>: 1. Model is trained on the dataset deprived by the t-shirt class. 2. The distribution of the image embeddings of train and test set are compared with the ones of the t-shirt test set. The goal is to determine if null hypothesis is correctly rejected, meaning that we are able to determine that embeddings on an unseen image class do not come from the original population. 3. Train set is modified with an adversarial attack. 4. The embeddings distribution of the modified training test are
compared with the original ones. Again, if null hypothesis is rejected means that PERMANOVA could be used to detect if model is making predictions on corrupted images.</p>
<p><img alt="Fashion-MNIST-dataset-Activeloop-Platform-visualization-image.webp" src="data:image/webp;base64,UklGRmBeAABXRUJQVlA4IFReAAAQEAKdASruAngBPok4mEelI6UhLJKfQKARCWluIDTW5YIGA3nl+STeo8vv7NwzluImTkob/MP8v/pfSr8w/gf9Z/kf3H/wHqL5n/h/8P+53s/Zv+2nVB+fflj+Z/g/aN/ef+TyF+afmj8EH5r/Wv9vwvIC/1r/Ff9jxhNgfx10m+THNX/3vq4f7/oC+xfSGAzqsY1HsHIMMQup8Pf5JDLdAm7zupQDhLSpD1P7mZS7IGDHW8IPViV9lhLjiS8u7ZuzDgEkByCvtf8YX7lj6XVxq7ere5XlW09oZx/tlSnRDKBI9ikmvIYvxm2ZFli9JGNWKmm+8nnrLOb9gXaJZJyZ9VMVkbgexETOy/2ROGXd1fYM0ARur9MzncsuJLixWGCDPQaPv9mRTdsECSy1QHIZu50JSboE0i8YAm5mgGa3JnyyiGxUSKiduTCkRCUmz4o9Vpag1L6g5ZUYa7nMUghDOmMMkdVtIZgITMJAdVMIGgaHUHrvqq720AI7XRJCBDAwn3Bo7qyKKmjAguGsOj6vk5uSXTjG3KIxJC9RrNW2eviHBUQQLCwmRwgtGF+FO91BTE9bJhbX90hcDB3fALOb6qnlaVGIQpziq3Y9W6x2hJMokd71icx5XlU/gOAcFsgHu+lUTcHVy4NqwE5G8UBU5s4zNQvPytNik2LU2UGCfZ+zJNxhPP8z/S+OMLKcM8moR0sow2jBeFDgVzX6u2wGAR3ENibHTKE93h+RfA4Oz8sRTujvWF0BOR4I/X6WoUaLBzdXNg4oRhgHmSKLtyBpHLdYXrgEKjzdX72L9CtZnPkVd48arC9CFODyXwwtaghvWRXn/omgg6+amZBgiamh4vh64N+5jvrmFReiqfn5nyqu5Y3CHi033b69hYsGOp4Czt4ir/37o9NKj52c3kH8CeqSXJIa8AZSYQVh6j/CWFJbm78P5aedYtvxJf+QQ+I9fNbJksMWkn40gpEwL5wWFU61Z0zF4JHS5ozjVmkXixR+5FoUetSy8xXLkNYqlUtgIBQGTE1ZthAcYfvZombGdLovFXgT80CwNh0B9DPKs2Zsy3lcsYMGxFHik3Du6ADx0RdcU74qmj3cMYv7PEQ7gNgIwghxdafLu/kfiRs9sZ0/RoXbxkqv4/W4qIrXGrR7O2ZlRrZd6oFhbfqLWImciLyAP0GZ6iUw2DvhuOZrklw5D0akSYOllaZjwxgO9Solrb6rPeo2/5dUIMp0hE0HsVdjWUYQzJTjkEGUSuX6CId/DlBYjuq++B1JOrhj83v+73w9hKZGmAETxF5l1T+q+I+5DquymaT0TATPsM0Fnfp5axk662HyzV35yw8jRCt9zOxu5qHrOkl0PG2R+ufNkGC1rCw/WNJleb6lqkA1iEWchajM1xLqrT4MNqcQ6F/qU3pMMT4x6nqPRrQw/9MZxMZAtxKzbhMk9XCVmyAxoj+W7Pydg+Ckyyr44Mi/UGWtFAEIJLTizK4cpy3XIcgg+QbM9GC4q4aBlAZZ2NnDS5ZiB7syFiOS0LjGaoWLtUPVs0WHOv8k4/Xa1tI6PpzyJq2OElRnkJr2ipsd183JVfigeo6D1+yxCvMy0FiXfkCBslJIb7nBVbdjOtiaZb2motbmzv8aTidZVSXIn14OYti2+Gg7mRBKrSakpj3LPlceEysbTq8XNhpu7lPSWFsij2G2ajHyrWa4j7Ojyy6bU3EhTiF07w+B5ysxK/8hUrMf1RnAiUml83c4JAbty1q2QFnT8xTbT3ltIg1G8iBGXgqDufT/psQt7MCNhjbGzRufUtKakjSHqGHBiDJsS//JVIZ1OAL3O/zw26v2EmWiKkVxuVK5xQmG/I82LPh2Zm1j4VDsqFNZ54KA+rlcisSTBxM19znDgxyNJvMKRchB4G1qN4zL381EKs3DsKBup1hP91+y8dv/3YQCvjMUiwkU9PHQNytt7xdCOmEBzjLKjK19+kqqA0dM2KvcpFlYoPn8oo2FASc7h9xdRkjSqFR7wz7RMgP0411537djfqnNZosk9jDtsF6vEbfOwTEPf0VRq/uWpQBgQr0nBBsgn6wsQMgW4qqhU6l5dI1LbscTeHKksbbWINOdUNqK4xU5rCGxmm7JaTsSuaCa/nJzwcuX2LwNXDUDSoUwKLXpqmUcjdBWt/yUCM8EsLafbscI1D20RYJa/XTFEafa7QLTmMcYpwvz3s5yPXEqGggCBc2JMJhIaa+Wnt1n074APsIBwCjhzXronM8WsDy/2cGEN0Okt72P/2G0goE4WC47HDwh6VrxImjFoWPhPYZ6KWZgYQKkVu4WO+ItywiUwYHUk68JKEN0ngRYxPFWmuHqZssT1irhoXOey6qBVph4adLZMF/QVmYhCAhv6pHouI3FpXrAX2l4B5QhBkqRRulvWZ5/J7oDVAPk2H70pKWKKaqKVoZbkpDEyXD/4EAFuCYAhyY1HcdeYO8U52XT+F16fumjkVqR3QZiT7/vc+rZvkOSZsfU7TeDGA3g7MmJBX//oqAlp79SkPWfsMXWAyAYnUyWx157jGhCIcp1kuR//Pwfk8MIRnaLm6yPMMvAa1zZE1jpI2UPquX81ItRIKf5XUqT0GxRi0O8rdmZm0v1JAkVz9HF4JQE31s1VZ1eMhkIRvPck1eQYt9ljBYDUguOz3rrkDamyDPIQu3gKFUnXl1CK8gmp5i5o4azavWcSx4gKFUHGis+0R9TNgCDKwJtVDrvZO6ZH1NPiHUc0z8BpPDIYdvnsx7xzaTJxQx2WV0zO3TlCF0trKlKK6QCHB0NcTSRK0f5x+V04jNzwvT4ALu7sYLOqo5w59Y3pNpDg1bPUxDYafBopJQT7AKpHeDfEOUm4//FPUe/X4+5zs66EMthdGsLYI29R09A8lGEPtHUYykQhSPz+xMFtlnC3IeilN6YfhbHAVA18qY/mleBXgRrf18ajbNHXq6nvVuq4XV7Yfe0wlpddBLuLyuS/zh23hVWn0BQyyEkBbYC+nd1x+WIaA84kS5n20CJnp3sNNQ7klys3xu0+qPTIBS/2qkOfy9tT63qVWHn3WNPIDie2Lwnyq1rqDQIGkcpZ5AFhIXYzI3nJVGYtBYmM/GyjGXnynSwmS1rp07NccCxa+ofgyN1MlX0e/Wh82A5dThWUM1VwmOgax3J583YQ2SUruFz4qgXJUyYTR9GY5gyWw8V/2j28PqEA0/6WeUmoG1a+4miEdiLLQfy7Kad1H/PCxR3atGMfeeZxVPBohgrcVTyDjx9gTdqojbJ0J7wiH4iLRR92GdeD6Y8kgsbzwSRuckr20fSas8tC6P2glanlzrEAy4hYjCBFWrKYAqm2tfHv1Fg0mCpzhhI00s2KyPqrJUakNMesCJdtFMqcORgn0E77QXahPZ/YpPLnPKDvPAHxr4RI7iOS955pIb2NbIMkoX/SgNHOeRj3NEdMWUwnDw0fcei6ZK4CnnONuJ3lhQ3B7ggeuG0bRof6S77OusojuWTYVqzDlWm3yQLjAWGrienO9+hcnL83EL0Q8z7E0lIXA7Z1nwtEgd95Y4H2dHxTwFQ91MVPDlioGzjOuNFA0IbVB/46TVVgi1118O5UwHTxfFLlgMXhhtm47cvhUF82snIc/THxjWMEWeBTJUPO1KTb5w9Cw0D87tFWubazNYTRAC7ZLHLvb4TeWsom4hEEMdeF/kuG7T39Kk6Y+BnFD+uVA0p3elzeCk97Kx56CB/Bll35rrVyKRZjgnfRLxefLBccBSxb1TiYyFf9z2slQAH3rcgK/P/gzew3l6xF8VzXSyfieWobCdLw3COSfXtnsNWLLtbUFWy6Op/rDARxuMQ2BwyGX0hbBtODmOtOjmLPB8kLQLJV0cModjjh9jtZcg45ZlRccb7UzNCbinJ8N0j07yhLOZJCaIl1t4bJzEhddqHZOdCkCSKaERgWC9jvfclttyr23uLEm3Q2yiR3lrPudQLHGLlwt9/5aj9AKIZS2gNeWvU+Z5Guahwv2BzF/AD+f+tujjB++qsvMLj7nABrWuGMEI7CpY5hcXGUs3+MyEnXqRqIzEuaXWQX+DzocOloGldv6N68CjqyvuSyQ0fFZ+TzZJt76NeJOoh7thjPk2T94k4nCxdTJ6155BsLUJ7b0xRfH6GeUqBeme2SbvToVQ8r+AJYHnLdUrnoo+hf5xU8N38KW4rT8qy10CnVsLSm8jABy10t+qIHFe+A5WhrKJTxq2GiMDx0FWJbQtW266KZtTni1ub/IQW8+EwOCLXE1oF+z8Ug+h0NvGVtCoPsv+iKjfF4Cr7WOPG3FCIcUZeIznphebdQOQA+B9yKaKnxuipqtmGc6lgcX74OTCHlu1DoofzL1nr/kPPttFqyWpWSFAb82VyrngfFiE4rksY52FfVynFTw/RiS9R7HKdOmt4EalO2v3Xe97bwUIxFVlHNpS0ivFhaHSPgcnkxITzS6t1BMxKNnolpTdxj3rDjBXsxsKZGqAP2jSTgUOOh9IamzxWWfyDGjtfXjVt/HDinjvJAaJpzkCIhVR1nikkTLyks8wZDxVh+p5NT0G3gw/krYIjDZ2jhcJpsmuNBy1Ymfo5U3pcLmRIWnZIlPUeSXQN/E2lsNp7CNzD38dm0Z6t8C8BDj6lz+X6v9FhCKayC9K29x4eCPc7K7k+UGC4O1PcsXZGWDDfEEMCGJ9BWgKXHMUkq1lZIQ2WI6hUEZEOfJFl27nR7N57pzaSQL+/ksH8Aq6cU1T0+qHweHV2InQTw/rlm1sq0Vf/VkD/cEjcz2cC41hsfeWiivP/eGyj32pqgxvw+PKo0I9ErmFNIZ+B1eLMKNHK8Jb1pAghyfvKlQRnzPx5UzwSpdn3198CRmS4oa8QVn+uKJ7r/CRhmuHtTYf8UGGMiYyUfqPJ+kVV2LtTFv3rlBAUHKhSYsSY4OOa7iJCcM0pyriFKGyd2J1JIBMP3z/tEVrsZB5xZ9jlwrBv/1ikHAp+NFdygi6sa9/U3HjKnOo355wsXFgNf/WRTcBs5C/lQISo5twmnBROOVF1ZI2kj1N4Q3RTbtAJgt76LBEME33Vd+6zieGGLT04gLKceg/01Yoo7unjjSE5qb7w/ivjzO+ckiaXvYijXTZ47M80f/KmSKH7Ouy5SnFhU8Pw5N79wKbrd8Id3bBAwcnlKazmND7UEIvchCHW31c3SlSfSi7jFx+yOqJIFbcP/wunkbPQNhI+9BajqULbcInD1pGF2tporOQh1eFpvdeDNaow585sb2ErQq5nw//wTV6u8h7E90XMCv9rzpV6uUWduojs3Lw9WEbwwVI3DKTLgPl2mZJUagmjinDpaJszA2IYucf6SlSebqM4iYMnvwu6fcWXHxaGJDZgMS8GU6fAjEYDhw+Z2oal69k0NTNLGxE/dC04AZWskIyGB4i5Fzb6W5TqkLaG32NUMQY7Ah0BUvYnRKpH12bjxgfs6ZiIvZOlBHp0kXjJ17DSiLy5VTafYDaZ76NmfDG3KR7TVK5owtDNSXAZ/aPZW3qJKibQDAq+vd6xEKyr6gvXyiU6bF6c5KoOdP/YgZjT4KWvBy/B8YfcLNOp7+aY7f9KIprUBBGKxjvMrlLHll6jBTgZEGvSArOLV3gxNKsIMEBgS3u+C5riD60Tn/5rzCAA/rGlD8nfs+fZq9v+Or6ovNeC44izMd4gQGsTEedJSR5OrEn7I3VT3Mvr1Hkn8HUMmF8UQqu2TBCvCFckalnjzGxASmqLNc5TANOoeI2h8nzkpnX+oEEGBlnzuWcrQKMdmq3lfZOFcsvDHXfgl+xTeoR11/axXX5ZlMhjUKKCjSL2vkedQKfOuzBLeb0PFx51at2Q+RpkvKtkMxfhPFoFQic7iH3xAV2/fL2XO6PYxwlWRAbl5/cQTRzoIoamls8F0eJxSqHDAMS5ZmqOOyAISPipceljH2XmeNDlNJOWH2SZA/mrnSyax7qPDswEgRsHluY+atYnR4yPZs+yuWl0KefKG29LaQvATY0p3o7F92ZBBnocKxwGr5rvwixt4o6fOEscTfT1VgqARZpWH3xCXOrRInJ3SQgja+uL1veMXxXxfjTwd7vP6ihs46313bG1DY6SV11GK7BfRB22cfu95yvrjNm+cSNJ0JMM8OJft0gQApgPIB/GKLo5Xsdr+8CO1z7r/j6X7hEWFjwHoS01BRAX4gyQJzjZxb87mkOaMvh6ww0dpzvXvgnBYBMkZVUfSvgvSLJrIlRGkjuD5Vws9oNtK6R9DVN7iOmU8q0sKm/wVK4FQx3Fc8DIyGtBNrSRWC0mn/uNesvUhzbbvKXAxVKj5laxiGpO0cZ9+9JMxY1CO71kabuGIZsfMm80waXWrEu4no6kfs+83+fwU5na/oorwCDQT+0Jx0ljIiIHzqXLUNavvSPdEGRfTyu4/F67JpFcCcmGRiM0bttIXh36ca9q90Yni+7y/uOb3e7m/TSQxwTCYSWrMerPInMxsz34zbOAixllAeX6DrIOWVSsBfL5Xi59Jht2v4/m/XCCR1x7r9xP168AIg958uBNgF8oWrzG+Ogfq5kGngL0vopsHNTw1MTzOJFUYhG5DlfuDPhq0c+VJRdqHbDAqenYk16dDVIdWFzpEsfBdIxpmUhJY+kmCzVQrbfk+SoC0mj8wKWJLfwuUMS5285zK12BtZzQNvMO6TvhMJrLEmUQOP6c5eTtgdZQSBdeavwF1cF0N9zZpitMQqE3EF2MeNAjhtx7GClKW+QJ6zMDXhpdf4rrXfh5meCjztaa1zR14WGfeN8XizsvdR324cSr68jeXX3vcyEK38XqmaVhqD8nvURhPevIaTyLKrgI8BU2g6N2MpC3dD4FN1v9qGLKCCP+dIlWfvQmXV7bYCWC2/Y0AUqD7HVcVbECkSiL3nMV7U9z3tNtLC9xT0MS1hoz6xnaiTOte9mH0FXlALjQPsijkKQzXilMeXQIbcH36hv32Pph+SXH9Yt5/JtLL252ZJ48wAlm9Vm6pvZ7/ISHsz8Iu7eDTuTqUnsCzxt9qaV7PIh1x5OJH71lZoM64CnlA0yUePAGwAE2ZGN6eMiY3+YMIzpcRhMdSwfc2FotkXgA4BwwfLDISuWiQf4hNTHSPSNcGpKM2jM19mXdmYW07iG13MEShvc9nWWruP9RggeAxeUoYygNQidN01xvU60iyZ3IBmssS5nA0e27Cdb3OuLZiU9EZbzJjFgtCEW2N7T/W5IXZs+jm1fVirgxyo78kIJ97RSbpGOAaBSOQ4lToSq3+kXDoKPDQ0u8VNXmNpa0liavXozPbeUzwPDlfY8O/bf8Aut88jTWHEcdF/wP5BJIfd9cD8UV3F6Lb7XL5wtSz5+LNx7rl/hKA1yHzloCA16ztE7GrYFclb3ZuswndH2/qj7FiL+7GMPMpKfah19NDPh+2LliUMRGGwqvZTPobqS9JGzQRibl+IYCBkGJcjEox3+9RI1NnNO72iDyimlroK90vrGz1p1x0HV8PKgyN9xHjnhe14QyxR8vYEMhky3m056Pzc8kmKXO0wbqsGxY/dtENxUfkIXBcnVSTzEs34Rkj3kxFWNAvEf93NWSD3rGkuxcr9amxmtmQ3OFD00lmBO+XOb+So/H2qzN5g53lCnUG97DmJDQFpnKNcWTlcpzumrQ18M5dRk2a2YP039cTUtJXUuTHp/k/GE7dK3tblvFYezUw/ugpPgAnB8Vqfx38BWKivmMHlaxkdWKDxxC0duZ43nRnX7I8Pksi5Nyumi5P3GvZ03JoXu/Spb8XQm0ylhuNZ+Nu7ifVXffqZIu97p+psiqGEKMFWhJbn6iRyIOtReqFc06f8YdfpimJB79RtrMaMPLIrRNRHAbIybJZcsjFev8Pg2I08sGfgu8yA8WiZ3UCntuDs9lpcHgHQczemJI1JvgqtSQZhfWq9suKv+ttZSztLUL+tNjAqPcufaQNcf+e33faPPjAG4MhwMaHBJ0ZtC7V1henfvQsZD7JdWA/5SofdC0k5qqSpsDyJ+GyuAd8UoyxkMCU8uQvsNVcGFFipY5rKoyAKLtNYDmP+yrZ7zaSJUML4gjyvcSn3SXBhfnbcHer1hBugHNwrjn5HMujiGno0hzjWr7qHoZfgPydr+7+BKY+lCI64QXyn+CHDMCySitSau9uTITRyN9KYPcWnej7R1ZUeh29X8t4jaOPBfkc0XTdO93khhvIzpfQwS+M5eh9L4+b8dWAPJCMfBEyW39ALmweF680Su47RuwHNbAPoqW4HSPOjKOC+25YsOkswWJJ2VcHvWmk/XMK93r+a0IlQK5D3N3zUU1dOZIe1lyy6jChrifY60HnO2vOqaiKfrVct/Yp8suz7nxx9NeYyG50j5J7Vhk9a/cjo48Qi1QOViOfvJ9iSMRM6VDAxFRVq4/I12SWl2A9eKz1mPbKUsmNcf32xb28h9YBaRayWj1/P/KLR1FjeOeRXLv3iw17Xft+FIMz4v8nmfAxg8HPmCTVgA9uIrgolQJSfOJfLyDGJAv+S/ak2hmJEYQiQ5Y1adIN04Hmv1CZHY7pRuqfASM5PPgyhFMcqhQZhOvOzdkjttBwzH4WFQJTCD8kW8umN5gnsK5w2x8o+VFrjfKHzxnm1/e9dklDbQLeDFu11T/fz6C7HTtvJ9ezco8MHcHMybJmRIVvp5SwMGfXqwdQWsTfMEZr8rQWyL+Z+R49xUsm2Xoq7KfBHfL0whlEteCbWFWBAw8PW57Y6ErIaUWkev6P48p7dQWqO2fzEbhj/cEvyDRp3FQgHfbk3jHs0WQZFEQDaCzJsqN5j+osemV2TqKOBuuxIVR24uw3xaDj4ptYjx2aCQIOzlh8+9cUWUGZyOF5OywvDlXxWF9V1VUsAfNA92beuYf5KPBRJWReXm14pcS4VSrsbWrSt7ib7GTHjE4i0Zy08SKNyeQ2DLtDF/gi2cFOH15X1ooBp3Q1Q9TQlHIcJJjzx9/9KP1g5bT37UliQ/DmEm+siwDGmLkVlwjWLuv0trQU86CXC/BKHo6uevKqitdQZmXpu9CvE/7nkqWAQNGWJFAfF7EhNwywZSWpSZAH1cD55DwwSZ9AQUvBjYLbN90WdTxhaJ7PUDbSR1HzhaNv8EBQfijmV7uPtM2hablNTbHsE0SEWccnbhLNb2B5O+ImHLhrIAdjoTe+N7JQmtjAI3aQuoPslclthsmZRkYmKfO0God3boi/FVIe4T2mkKVFXoSPkFWTXRXiDWFSLnKW2Tm56Hn/lZXOBiD2tzIOfLEAKaMPfvYIMQGFVKXoz0D7cruT7n4L5XeNdAWQSmfvvly82+O3MOcMh/nQxTj0Q9DEC03giOhz7DEPu10rjyJ/pts8IWhRYhKDrFgg3VX3AuxZbwdgwsDndG014lF5K+yuh1ad9r+ZOd5RRQNGfxmk5bj1E5Vp4w75ULHJUx6whbWtKTcPHi1KofueC8TTP5VE77Cg32BM+aJqgyvG36IiAfR2cuxmley+gG+fplvmCqacCsL1XMme3qXS1dlIsrILSgvMMNr3NKQ4RHISs0QFhTdm4u6pxEsW1cQhO9G+zDRmZMQ1pTjYM6VSUfAErlMedK/6fu/zjmS7HBzly2bPsbsUImzonjnORs9OHY4yM4In4rElbLj6Auo2VQRr9zyV2ekQ/ECbOyRgIkp2PzaqMViBSTlqJTnas9+FoTvn2PjZxxGCU72wYIVUTVGwIz5YjHSEhBW646VGgQdcErCO2guCF+P1oSm0DqOuBRKkdD3Pxm7w2iREz+Nbz/t3wa7Wfmpxht5FJ8Yxqs81Fd0NW+PfEj5oPSIpMN4nKGZxAhaTSkK3x+PIpIs4E5cu1HfajVIlxnA//407ysUhZd8hhkoB4PQi/b4/30ZjGzCNq61LoGrpBMHc8J5Kf+STLzc3ktg+tGkr1HMBupDH2/vZ27cyUfkNDa0kS0oBVK+L+AGWPv5RBuuxIYtGXHSpTu827F+iMSq8LViyOvJdakEqbl/+wh5PR6PA5RkHHU5IcIWk/aEkTJ0es2ZUD3EhUF4lmJohBU3LgN7tiQMbvfqpSWbmAG5NrsO8dhU/SaLs+8ZYTbNDSc233gLl4yCtrrZrIb8g69IRGGiHGXLTk1xt3KlDwUk2GhFUsQFMXhTfcA7jUFNHSDlEIsNmC/Gjm7A1Utx4iQaBWovw3cexX6s9ZJxwyvOkgtOKWChVQbmHpN4b/5viRvFSfXhtfziUuTX3i37R6Ubg8xwqitqNWaFvldJbomGLYgtYVZ4BZUJXQH4mOLGKCjwQiQtQgFm6CAJqDckNnF7JHw6E1000SZTEvCCvax9nzr9b7AWF8LebV17U8ziwttJ6UeRnhSMGfWkejwzNq3uSxg7wm28LyXqH0E3pZwK40zPwbUe2XHnKtCzt4TwyV2M7ad0WPicYn7gAYo0rePlETQfU92MQANPB6avCLH2AV/EjQ1cuVhLpU9Y4L7Jl4sSADSgBgZ+BykKgaPZJZBpDc1zT8Wyi2pFvgodMrkjMo4QYhZIpC2AC73YAFM6Zma6xLIFm/vsFjTeukk1yU00Sz0eYLHxuoxfNncbVJiT1TDNOe3lK120rqsjhbr0NbZ8dhnYY5n74AXOATqDGDAPVUiXyVcbdJ7dsH/I/Kz0XGR4JQRUvZkRMrqnJsFsw6W+76o43GHrDVivRYWuNo4G4EPkihbBBK4Bx/otyppEw346lRKszZ5fj15pMbLo4f6ez99JGwfNZ3+7J5gmtrIpM9SDiFYffyBOjsO+PuH3Kscr2Jr7d7yl2R+LrqtNOQUxPrX5Fsra97RguarjhVmc6vBsuHM5wqDWCaG8QnIO4jaTusMGEYCpfmbX0iAepMSVixafMBlQMuWS/vWzl9R6/M80XOTR7sSfcPUJN68Z1YVx4sdW8cfppupf4RBLTO3XLTP6pKVUSq/KMF2akkejLaMN/Zt5n+bljho5OTacGT7Cwv6GFcpu0JYnPxvoXxH/3lcNopcKOjbWJdD72HM8zausOBrLE7RcYkYiLlKD6D/CN/VGl/CMOReWnpXq0c9hc9gvz5JB8/xBSZnc91wq3sYngpV61FB3E8033VtYSGhbWdjjfrPQOCUm7vHi7eG8yyva7zoYWnsMyJFjMBfwH8aLCFiORVIM4allfPS5jHQ4pIrFcONJKRRWqrgRGCUMzMyAaLhPQFmCvRwg2AjHjTU+7qL13gjpj+1Wts+SzT2ngrqnOlZAP/f7x+//+dkNzSgaOJF52OVb6nt2z1z38n7lWU7hYbWHdwfNhanCfcl3xF/aihkC2koR6gECIIRLV9nSVLAEWiIsLjUC2EKisna5B8RgAFnhR0l5jOxyFnDvhKT2LaMPrOAsYPU+8EW/4roEJb/ezm61493np+kDIX67KsHDlK8/fVZ8EU5q/HyrGIGrU0rcA1do02CAWaNmB4Jj/OV/mIwjXwwDjEbWVu4nqbFiJy49Zo7OP9svnsZL7ch/ZvP1b5tN/ow2UCaT7bC1jBDOzrzhGp2Uf3ZVgsAsgqlGa+dICDSEmMkpwdqqkB3fKOSFqxfJtpiy5+X1HcqmcVCtHkJAmbYxXVvp9Z0/cjIJmkj2aO8qp6h3GidV1l+ct3X3GXud5gXx6856Gd79DwM5/I+14Xm3w8Kry4T1GBBIpd7Ij3w9J+A+KagT9X9mqaXmjs0pFL43RoxRJ7AJMJ2FMmsPvmIfqAEdhE7ZEaEhOe4y54cWZ3P3F4dbHunitgvQnpA1U+fASYvunXWwRGEVpc7wktsO85s3BiANGoN+VvPiF48E272Vkzmy4+H9IPxSfiZDUgqHYaFyXMXbNwFjEApGEJEEn7YwK73GEzrY9myr/oxI9LVsBtU3JosU1oh3v48nXFnmUsTrNxjsw77UFaoSXeZWkKC/yQGKv6Vl7Iqxidr7qDs7IR5xzPr8i44gmPtxNx4sJx6N441XQosULAQ/m+91u97SDEZbMRa19lfeRzSAcYPpFi9RQdVjDXq5Dq6/Y0OVxMIkIXPD3ClE0o4WiNvOymPuUqbQN1xz/MA6UfZIcGCgsw9p7ArUmir+T4Jiu6Q4f4zxqrxzXcD6N/sZ1pvoySMAuH2coWM9ljf7aqOv45s14XgrEB0hddgkXqSUV9MMaT9T/RHPIPvu911n1g2qepKldyPJmO/ZI1gwK1KnRrW674AXYnRCQAUfkacSadQETCZz8paFjpAY05oYaUvYpBmOE3lUlppRbwpvKZwh8ms245ddGWcLgojU8U3fSgjCj9612EMAURw+r6j5iOO5CziB0wEWCgIt+RsMlmZT9HEdePNZrKq6bLoBiyh3weULMsJeZVh/yux3difrt6SqPRNsp3sF9cCLeNqkcaqWBTSiH3SlrmO+cN4qAN6wPQcTX+5FRu6gz1s8YbQC9pPaMphv9cxZ5cmeUyX6CDFIBS4et4TnaWrZpxyWW8NWmG2OS4lOuoiTdz28Lr0Xrr1HzT5Hbo3Vbzhe3FS/rZf+bl1eZcB4KuLtNCpaDgxnfSQ0ProQ66kbTlXJm1RXb5/xBLKYlip1Zyw5H1R62b6u8WxN7njghOHCsccvmby/QfqF9IwNntMPX1coK/fWLUB0ssR6ElRWXI2tjUL0Hn0RcjC1Iyvw6V4sThCvAlGq//u68RofbPsI3fuNoShSwpmyiy4IRfAzavK9pPgM14jReuuNc5Inz7aR076mEkF8yIfRWv5Imi5536IF6SM0GTfhfsRGYMLU7DBwIMOT52kp27SX0J6F8VWeGVJFnlQ52Z2DORnMI+LkUij6dPTQgu63UFSi+bNvK+uoTay4Q9dfClWjr7OmxoM0pC8QMShVRplHKlOHX9zkXRnJqT+8Li8nJJNSWnZftmz23rkeSj1YxzQUOITy653ZerCWvX/9A0JTbnxJK4J4qYW9l7R+Gdeo+XjFV5W88Is+aJ9i45I6o3eYYOkMpehxOgfQylfjGGA6r+DMrp1BWFAv/oJQ5NaqcsJwhq21tbF6TONQENk8UZAn5AWE9/0riwxRfezjVB3G75aDORmdf67/kuNY8RVZJFqk4vC1f3q8OW0QWtKrbP32JMh9jd9AMIRHthNJGwkGEOk0bnD2J0rL+U/Im0hdT+Mzy+GSDOgcYFRmANP8XYboGM/CeiFebmzOtlqtyO1crL7YCgzj70N8pUMU7ODuw53AiyA6WXFeDEmeFbriK7tghmsobvcAUMxrmVFv369vV4jZ5w+ymlKQZOo6B6gU45IEemSYQ0cHFiGABCAbg9RHfPTAFz2FlIzF5F9/IrV5/DH400a0LOenR61ounCijW4pa9DNrjnPNwaTVVgcU37dlh3hpq0lJ7TRHbe9DpudCq97B2R1hg/xMGuDydF3N8IliO8FATI35d+NUqcs/SSsvZEzjvAbixQB+0TeEj7deqU89DGEi0dn5oTpHvA8IqIIwluqxBFgXO3dO2zJAcWHvFCjTT0bYM9DJOBAMNtzg/X4DAtotgGmFm98Dt1T6KXytjdJ+xL5+3xm0sn1pRYu5Oq7+Wty2tXSX3hvlZ1nPHsFvORDS3KdCt1LVRVU5ET+bgmiLajK42NUBQQQfKWMI8vK0k6W4M0mQTQmGp4dtiZfDdu9+WUpBe/a/6fw4iaAU+nxlB6hXHfTj5uYXKi507p71K0ky1tzbtazwvUi3dmYnwn8OCWP2xQf2SeoF65TwPPV61P/5I5B7oqAtFXwfh3fq+7Jp9r4RpGlHbK+29pU1PmJU99IM/LnOrQvVl7mSoRnNtYIIJPnGw6KnGH2IHTHL19pCVNPnUsl6c9ZIQhhnsacoNpR9G1wvYMM2uwcNy38cguDOxsTWttgXjqKVcAqMUd9TGmkIBtfYCcZTRI4GAM+lJKzIQ2493l1T3zrBLWt6SrA5pfwVkDNW1qAdfMGZ/cFsfx3OeTLL84YJVWpg+S4IurxqcgPuJI9AwsMtzgKQMRUMbB2TyBpF1Q6UdV/uI9b4ffnyCaULY7PhIMiJxc9rCIyfngJtZQYBURzn0U6VjaY0hBOUG32MsQbwNDqabsXzkdZggIQhhu2T6vlLzzekXOELsYnDXz0nJNC53bk6hT0j2CyLHYwdjsbAo/w/6mq3VzPFGTXAVtyfnRLGsdttC1iKzF8DelpnHc4L5vWYrJFD/xnIILOeik2Tn0YNWSgquCdRQp2nKWt3nQ/Rdz4zKeoGMDpDqHHrQmCH6WPRQCWpeRppq+8MyLEaSle6pd+nGSe+BIysnK4sRzriWTsM9vzvYs8UXGbv3czjBWAsCJJ+vR+UDV+pNHDxD99rfaYIlncHWJjU90ihHyOqExX3kaEMBhd0gKKlwa8FhsUoxKStFwz//Lr7yPocTo1bBlK4UoBKXxxr2PFBnLY25HUKMktrPa2yQeq3Pm/mYNfq45qV750anrtuyhRzXvf4Xzo4aWk8zi2sTIlBZOWMOKA8fOEZYuIyrPoOCiFHWIuTWi+NICiy0CMDJeuKV6U9bXonFay160jaERwsB3QxvWOelj9p90rcUFmAA05+HV10on94fpGVmR8DXnDudNG507zg5CQWRuLVYyXrcTiHX9fCGOOVyggCTXVkV91wUzVvL1C71i8BO/4twT7nhqm72iD2tSkQa1qfZ1K5cmecdbtGJMcCt6t+qacaSi9R8Cae4C58seq79WPrLawCCIDBa7MRfJh5XQaGx0vn6EzcQxTAj+As1Aeuwrm22NVPIyL+kM0EzullWPn77EUriQQXkuHZGsXbVvwtEhvqckJkcgCA8oQsEaNzf9gzvEQUPZiPWsdnQ3FG1nlL8AFgp1I70vHs1ZQ1ndQ0zB9QclFESEMQxG6+SBHtdVBJ8jD48PwdNkIkYyBGD2nR7kgjXH2s+SbWl8Zh9A6fZiSKcNFajuS5Dele3Jucp6iW2Q9QemRVQ84VovVmmSSMQ0s7W1bJ+IGxxn0JCjYT/ZNtVf3WwVyBtjBOuf0/JtwonF2q/tno9h0iVtgOr1hT3nT/l89fx24ZOGMI57pDivYl9IEw7zwIquoKWwOmWrqWGN99JxWKTZt0UNv0qMdXxDLAVno6F3G07LkVTKqzELVUmq5aYbD19PcFWB/VMIFYCEq53gil66OTS5U/x3hOSjJTl2LvnrThO0BxhewLs5znnVD7RLSYbKJ5RsCVOVe7S94Q3IZw+OoUJXqIjPTDjS/Wxg3xVwryRtVyw2J/iMfFkQxn9vNLOEtIvWWQL/5JNiWaqZF5EIgalLbFWL5QAF/t+ayuKQMz9d9o8hcxmRJmCbnXYI7dSMbp9CLM4ba1aNpowZ8cjGTJqwmM2uy2n7sn/G3ePlmAqOMYGWVL2QY4a28D+WYbUuEY+25U8LIRMzEZhMRqaUHGuf5zRqWLv4A0Fr9+Gn20RFRxie2ZaXsWEaChc4jkvPuwAy/HF3fMyePZiSGrRGpTSWXCa3hP/lIQyFG9zRTxsvA9yprnlLI/96QKALqyEhOfUWwYCqqnNv6xXLOWWOUWyyzJxhduLG0ufiUR815mONAUe6cJSTGx3w+MUa8kU7QbyNfdZXecdNhApjMyGPsb/K07dAddnXJNsW8c1eVZJmDwPyhdlM9JB5aXUApnaNCMTCCphriwguhKOAdZitghvu6NKXLku2a0iqUIRvRk0A4APTUvHYUGLKhqHTttxuvrGm1/bfRkbQ3PCkjrMAOfohsIv27yG9BhPCbW1xPWOw8QDu5JKRsb4kTf6VTn/D0wuSy1X8/aNBZf5ww0O+6Cr+Z8Q4iguEzsEyWktc+Cs8y1fQr1ududr4TJoGibaJYBhqKrQSxxK1fkIXmBMg2uYjOL2NKJeh/AAUqcJEtVCBu++BxLRR7OTCc1m0U5RMUiib4U1hQTcnzlN0UuRc2otGKZb7hO7YN5Cv124Z7B24AEKG1LzVrovxNb8hpFH+llBU6gDPbB+fUpmDvpXFv0T9nihhjgTyiV3tT6vH1bjc1lW752z2lnvIcuZQKxXET7UnmB8nTnyHLQC/VN+GZSdVa3iyneEpwmLobI6VTDqWeUXGHPeBTsChKg1EuU/5pfBMRSABSDFs36PgYtcGqUM+UoQRKycCmTbI7x8q4VMTRna5TCC/mV/p8mUNySUhyhyhFA1tj7FDD4n5sMBxFF81PNVVxx7Ka9k+P8XhlGS1VCoZxIhBQFRTlLynwsRCg8zqChZSky/KJy24/hXQ0E/on+HaGThWy7FF0TZdQJEeOlS8xXa8vBXFPmyfN29kFBxg1Cw7046Z6bNRFgejDF9pOXZhCsBH5qeeiQIePHH3QvXoceSskMC9+V68TClH+x1U7eyNNwUHnr4SrZLcj3ehWTnLDDsJtA/qDqWgqHKJAAtSbVDGbo8sA4UbNOfSdzm9g3fB7h+Ns+/Zw3IgbpI1oa/xmwLnItTz7/AkRf0Q0t0pgqarzaB2UoDllDR58+n8tw+FxzyyQy7+hbjZQroMFXnyP+GR5rIRFWrm6GkYWy4zaL/MWW8idXNP8QfDIAdshUskAiz0g/rfRub0H+w1SJQVYaNcPOIEg233vnkPyOm78Wpws/7mqf/0ueNXUwE6tsF5OeHVpnKo6hULAr3DGdfz1GneWvQrpp2LnwDgD3hSKM6BAzJZrPUtz6Xoruxjjmv5lBurw9kqapKxIE1Clvj7N8noelodyew0amZdrgOlXNEjARN18zI174XfAI3dUOQ9+5We/qzdHfiptf89DuV1rbALaS5rAifMnLFddSj5h5NKjNJuJizdg4FFisWbLTP9LL+D5j4dGfxM2Wn9DYyl7o7k8JEuosQGhJJ3TbJDfvYqdK+PTr7joHtc+Kwj1O1NLUZ+3ByQIoPAqs9iv8Yime2fwGqFNGDOJ9g4nXZ7BpwmoaD6Cx1YVyE97i4CkC1l00Xp6XOhhikQL0hx7eWylKhz7P3ll5w8/UYhZAYF9JygmMWjXyUZUySfGKUZz5q8Gkv3CzqWaQx37y8aQUNpSuL8szyHt/KMOo7C8TcHDj/dNqmFTUmN2zg/cLSe69/6VP9BSry4ylWgp032wWP+a1X6cF0THEOCPNi+npdAkliUBVR9rFaGzWkqWfptEq9gn48mVmcztcfyz2fK2iQQv3qGzVQHe/dv5KG25iRexftWxsh2508rwOm3g9DWZbv5+SVlgKP4sYzs7RvB+lRwX3IgHl4bZuTihO6cHgWLTUcyQ4x40fe49EOzQTATCi9OZhmn3XBjID/z5B3TPIFTrRfgrb9qGU7+HUTWfnbNu6t6RagH8uecu0RYNRpQmagz2chnE+St/zp2mftWbk6Os8pUGfdz5YKxiJWozkP4Ik4xJaWmMpw9FJphnWOg/JBsWf70R8Nkxvl+w0dpcM+kpk3YNw2NtbLpkJCR1PMy2lU4n6wDUaLxjsAnaRubCnxPdukkNwX7rk2vzWcJx//c/A1jFTyKjJGzooOWvZIFCMStVKyNQUi7APcnWGFqXtgb8ut67HIoMUU5x2uTypKP/x7lVWC6FjAh3hdZyMyzuNOOaiqaYCnOOmMFFiO6OkJH6L5vgFvxySO4/IlJL5LyHW/47xPBvUyUTaiUSnB25n3uooDBi5dr9ncbMcoz/M2yiVmFYD8KBPpzvslaCkaQWcZlG1eNUfYdL+ULzqAU2VXHYZsdIH08Qg9ptR6mNeu32JN3MQRm5Y6Ej8jVNNGG3EZFyXipIAz1vMPAGKSUUntjvHjbqvYieAsX54NtavnINFSNQnfMOtwAG6pYMfEDcEmaf+xkxGxPqUrdheFuoSyyS37LYVC3iiwiLuwcMzYSEuH/GpWL+gREkSXE/cfvtejMvzXNRaRnxJ1t0FtSuAbBtZvQ8MzJOvS5QkK9dYu5Ol3AVLPNVfavnFhcaQsi/do45CK2Ymb5Gh6+jOGRiyZxP7eljGGIVxBEuGAAlvtkkPnVzziijJCTJfm7cmLs57EqhaKzrLeVDNVr6LdLqJ+DQSQdqkfu3w/oM0c5eLvob2ehFQyeNbdgDmM27eI3tZcDxjuL/9J3116ZTv+Rb7G624GKaPbsrCc5ZNZLAiYyz+2VZ5eO6BqPDrxZ7lVglZdiQEKzrHBq3QrNx+tezsVJ/PB7nfvxSWx/Vcj3vsNctRpncnCe1iJM2CgPHjMqs3OOwHaASj2Nc8XaHH2KSeFFmcJFzDqUTZBSftHRRghjNPYDR5BXYnX/oFCXrmJW8Xn1IwXBzUC9k6jxuMOUG+xqwas17K6nUeBIgreEsza+wpjp2nNHOzUKS/lUONTu8SQtciBS56ta1L8rRBVkX8egokJGwDuWADntCe87WLyRpQFZTE9lz4vUugfQmMVScd3qTnp+lzdOVtWob+mpNlW0/PurlbOoSZBUK5AKOa7H3ui/WlAWdAx+I1PsJVs0T0kjDpkj+rgwvHFPAAmrjvMqBuYRkjV3a1b/GrrgActqw1voxLazUYPkoyq9ntwEbB9M36oD0No3YOUTNiq0VXonQRUvsOFSek6GUC92wjoTD43f+N0JxUZe/0eBLpnbPsmJUl7MZCUoAM5j79+3NwK2t2L+bfaFm9oZ+soMfhpYdsthrhoY9qBgNKf2PE9YX4eZ9WyxDvm8rwUCFFja7VKbLqigbMX6ekbS6QzFUT0lO184hygzQqd2KGvYtjImt61MRLenhOtBWi0qXfvDrOfekwz8ShhIJBtdUi9KHvqrkrXtQgXBlnPcR1FCMF4KUM2sHJY0HcLToYC/TKj2SttCO3DBRa6HjOPOiwyjafKUXHVZtiwdLCiDzM/TlZwPHG6XpJE4JEBxXq5ePpW9BikG14I7azHEzSNkd62zhlMdjHRSb5Ijl6VZJY8fPXUX+DkNq+HJrlrruig07FOpf7tQOrKsxl21dTER762KxbfNl4iDVcfnS4wlpXjQkhKTvQBgFP7OdeDd+defHgT97jmNbBS3ez601xVzra0hrAUBCO5pb9qxngLHXz1JobdLoeal1NZvDH5/lZF4S6wbf4nTM5oGRBXIRvdnmx27WCWvP1pilYHmKnuNq0QjIYO2S5V45MFM9jdsNNpj/yu5d+DXDCSlOepDt5sUJ/wDXMSmP0CAfd9Xj5I5zm3Temj0HSQc/FgtaruDf+vlBV4wFaIU+9VJH4RVC+A63J2FLoiv57yja3i+6hqgR/R7vNdy9LWN8gy0xuyGECuy6LcZoTVJ/v2qGiKZC9YfyHgw0PLNQAf+fnSaynEuZUUpeUWGiqZktLswIuXlqjZtsWU2cDAVmfnOvQn0r7yPZa3wo1poKH9oqq4rzQj6O5Zc9sOoCgPkQN2rsezj9VuhWCZi93/ng4UOtJ7l7WU6uc4qYxFrFtVL0qCDzytPwcX5gkS2c574LAyakYHabs6WbJXPDE6CFiLpzmW+Zv5JWJcagwzYRIxb0cAIV9e6QQT5osrYUIuTvoFJEKhtiTpZb3UJyQDTZV7i/Mzdkcmt7EEx/+Gh5horZMegudcl+pQDJYb9vZiWexK2lwfUHKTU6yv8s0JqXauGvRUdFUf/XdIygBZtmsEmmz/9TQJxFrHxAngVqSSLPQg7FgPbLx4brEewkiQ3XjWr9/6P2IR/35pD9EwHC7aBAAM7qN0ODuGnaUDj9Y72z6iI/VdVaTiTnBUdg9M3cOo3FlCvhkYejlLx8WRzjXZIKgeuclTK70F+bsJkGhZBmmicmTGlaHIXonC7kyt4rhrNALwdwppwklOM4KKLt1Up9K2Q7WbnAwB+TbKgDW4qQ/AmgSmfvw9NaWCUMAS8omTt04kA9C6mtJ/BMy5dKFUb+AzLS1ggbmVAyVPrr+o8SWMnHyQyqEze5T3jiSgMAkNqv5XUgZlC8CxWHxssZuzIq8UTq2VVwmY82TvmBweoGM2AH8wCRPym7k8n0gstW/wjOGp9kW60GbW5gTF8ztNCJ+bnstLTlQIIeX9Bu+K0c6UsfqT27Yd7D+UZnTBdi3efB8k3GlJBa/88dM8JrZ4Z6rHuQB9xi/FvQ+7kb/LrbQ2jaAFy4+oY5ZEwOYnM8KNLWzae6+RFe85S/xHS0qOP8NpCAIXK7uamW35uroq5vryUIUuVBJaNQJrZduNwfcVqUi7rkZRlm4AJXGy6ZTmrC6i4XwnI644COGmE/ULJ+RdhDp3Pjw9C43NL2lBZM6rDSj0MxibOpg6ViJL995wGeORLlaPOlu1/YRbsb29oG5wWbnFLwlMNzMOj+KUp5vogtTywtH3XdQA8OB+UGNbQjs0Ae8xpVHOCD1g7XpwnAebdbKDWaY/a90JRnCFTrnEJZ0OHIfbEfZP9HMpT1B/0CueLCSCZs8XkooqNxGNvOsAC2KDF70cJSCNqbyxYLIa12dicUbE8M7QWIlH7mjEx8tvD2GvC+IqWMWRmdVoWfFIPfpJKQUzwm6xYLkXlKDM7CMnV1b5nAGHYJJDaf+n6YGvHfyWohfgXZtAmvQQbXHLtX6P6D05iFH4TejdRjJh2kKDkSAtpoVU5nN3kg9SvAvkGrzHp/mxftYipKhh1JnzAiuM8O+uL+52ff6+HVoR7EL9cJsIFhuoatcH6H44OS+J9SiOhgjeYGs8miuqhELCixi2o8gL690ow9Qg3+9Y/ukMg9ElPMK3kvMJkgAQcgMNXjjL1iFaEvNXa4K60cDJTHX5vVw5lqZzKnn66vmETc9QcEAC9LzrNrEhGVTnZeCH0/hy+NpkhBCgICZ0S4LC8qiQJb8BFlkm41tK4ff06JNIaUZH56IG6rxDMx+zO6iHrJPZWPPvgi6jRKSOMxGtPP08p7+Cb7hx+D3SnQ43wl1wuwDEE6cDiVhBXkYqqyEhdZjn8Of3N8l2mS8ND2rPdyWOvpuX1RYnvUuQi6PXVKqgIcDQOBqlKU2ngREhMR6KWzryEvUmYSc9LdjsE4lPDyhRiME0YwRrxBq4Xv/6hEzZWIFBdLhPlci9I+MRtuOhl/5h2z8T5gQcVa6kcXdqTgNlJiMfi+qTIYWgFs5VIFsCcVxdanJfZ6CgiLPVVeiUH3ghoO1noYEVPqsODBUqUmAHvJHnc7fIB0fUlsMAHRc4J9BgDmBDOvK+WTgLNJRHKCzpHQK63qpHB6FXEiPS3M+KorNbB9EGvI4aUvYMgTH1xLG1xjU+T2ECbUENZy+J27RSKDGL5AibwPIuuvh6IZKzChxBN5lGElYeZ0fy1kgG3nwQFCajkZ3to3Yp+6eyBUxD+AkVf6VKu2z8EungeKDaZYDM1qg0NtyhKElEOvjtn58Un3fyrW+09oBj6SETWwJHiffNSjLn0g+/Xcca6S2T0vgUSBmwpmdlo+3+od9/vEkvrr83W4/MkGyEYjms1cwbq3QxJU20HZ7SZCNThmWXFP0yCXVl2J3+eSoMM9++PLX/cVmlCenKGQTcNAAAr8NX/fDkBjAPPEO0evFX3ImhTDq1I+71UcLqhIm2Pm+ddmPZGRPNbPiVQOjfQ23LPU7WJACMXcEEbFhfHb1sMyG7QU0huDau4Re0sY+DGu0T01gPbbXINPiyd+lXnXakCq5ls/A86L0429Jztiq4+obZ44pCFdY8TxiYrGEJQxQIqo0txZbIrteTqEEbF/3paSPVrps4f/aJgrm3NjO8WxQa7YOfHql++eNRBnZO7Z8GKEyPlgrioF8EXZy1Ow54zUcqZS8DVR4PfrJK/k1jlpP41Wqouu4BB5hFPZhlnseliUOheXwj+3leTH/lU+R2LwRBeSvOzsJcEYfA7Ae7tAoX23yWbzZD8LnqP9baSPseCmjXbPmEHhU4TMNXoAvfZVegAW5vjQHkfW8zwtjkWy2pQkDSyV8ljnwapNfygtBkjBQa0qvuwRz374xWTl/syIaZgXG37j7QPNE+4/t4a14XxhP/yQ4eIr6Z5djahXZRnQrdgRfg/jhM1HgpetoQfs5v0mmSG6yfM+kzh8LIqi/5a4by9f99xYxPfhbP+udKKSpuiPsVvGeRwG1yBqzFaPIqmpTG3YPOTwNbYzab+Haw3om6tr9imAW03J/jOTOe1LCTJ7ZTkAkqZztIhguS4sudPNEMCOKe3MKZ3GUKzUQE1hpF5RJuzdyG5gQ/SH96qnoiAwoa0OuVmB6E8ZQZs5LAEmwJF6tJf29PNZfAZAatjvyE5leDmHlenYuPZ8W4LTNHnEBhiISHAe/lP+uA/wRAf4kdK0pLbv7Peth08KfyQdY7oam/Xk2Jqb0Yhzy0pgvNoo7cxm0qMCoN+Z5cc/W0h669ALpvdDcRfuoSTqpEMxTFec0UOELY8jTWvM1Jsa1Wndt6jcp2g/X+MHZgNMyAjDM8zBXSnsxCdPJJEHplVgWCqmMqExa579AOizvMT2n9/PNfetzko6A47tc/j6jw9OdFxnQo7JK/Hz4n8xaW2HvrufY9mAo9xESgaLjsfskCtJdv7JRjbfs9Vhw2rmds5xAfH7TqMDrzKzNrrykpfbwtcRGvgJQpTM+opYABrB3OG+wvH4j8pW2U5Ji810WOVw3koQbG6srEYNXKqseZDp0jhMR1nKluYevYeO0iyZ+ZA5qIjvCGksUva9JAJuiF+cmjIZdAtoZvclquI3F7Qq4yqQ7PzMwNRp6TScORi5eBQRImZoz04EXu8QrLz+pb/IcP9Le+RSinK0pA91k//1Cgq98UE41tlW/OgifCbJ/2q1dcZDJ4WyaQT9vGX2wQSCq5Sbvvr2PMgDkPN22L3qISWc+VrYwGw+FYmBswDeYtJpHQLJDZnx/Tuxa02CakGcmZPOjPwlHiJCApLA69jN3Mbwtne1vqr3JddUp8OlDA/AVBXuch/bNhczPHJbgQNTbRCiAtrzl3QooSCD6f4w7d53p5On9oJBXLsdxT9twX23Hm9tLUAFPOKistOPFNSeSkseTFd4TcyalGBnv8/xOb2vtSq38M3kzYXweFz5gdnKoX35p3D6Dk81T3oOQ60FIoh52/1QojYHGwBJCZkOFnrFytl/JshcJcnQA7FNsElDdy/O9jWcy3YVvKkH0sGOzHgGlU8uaRcKxLk9Gwp5MQOKLtV131yHOev+FRGnq4kh15wRlIaTYrDZLvSDi2Vz9LkU1sFEubkTTrf8aTYvbLBxOEDu3hh++h6zINktN7N134rAL+Pm+QlOcBqEXwD14T3FVcYO04TR7pVvVDW+9ZAN5mbOTQknYI5ZFi+sNd+5GMdbJ08iHBQlE/atVZTuLfhjMvmp+O4g7o/4ubQ78Ob6h166ydhnqQ6hPygENg4GXSd1YnVkIk+SaH/gWliDGYXkAl72qbiEtr8HuuFkaIOz8pEptJZaCOcAkJHZOPCawgHSEiagOR6LXr22qgHpLIarkBCKQUraU+FJWH8gqIZLKiYKoZxZHwcOu9ogkKG6kd9J+NWeR2uskMuUTwj/AXDXyfkxoS7zofSpUEuODxKpP8MILpkagiTDGdvIqy+uW3quM77UdMryyGiLPh5j1WcZkd3+RNVaQ65m8Et6FPTBhzVDuGvJDyDWK2/5edbIAllpNkLse9f772srgHY2z98CKbZM5Ps+R0bcNB7GVNZYl/1NPyTPWNfsZ6DHolhe4++zsA0r2YF7dpp/NVd5Fb2lo1hNU43Hsssi8fHLaFaHxIjyA4gVsH+NfJioYWem8gIBGmwfkBQbGtIWHZypu+3GCITc5ljOrP7cFNQ1Fzk2NXWAVx956S3unhv5HqNHOTJWL95iptZjbrYw5Wv7nI+kL/vTJxo8rNFHkN4CBYZeUpRFAI23E22vO0n5w1wqNycqmiAg79ZMVAuPUe1Vtp7SCyY+2lGWw8JrpvbIoBiPNYGWMwYWcqsmkqbmPSM9GUliXnypB4nLeDBmS+ouf79l+VjusA/PnqW7iIQbPnsarONBb8MNXPn+kTHsD3fz41oA9m/jSpbGwDy7FZiKcCmE6s5F83+vhCwP3B0D12Puk8Ls0AJECwWMuqlaCLFUqhshBrTz4WNd/PHggN+WmJmY3mirj3wZuX8boE6F22niaYLETt2SehavxMt6PmfFkFnw57PVxMzNxBdTHkiPIs3ZcLKcG/0BSrYrvTKYNJyPir1EflN7nsWShv3LkAuAZV1ymAeo/XMSeagSRjk9DGceBIcFUGRLP0RB5Uw1aqaylaCURRNEuSS6chdE/mJHlH+KrjA/RZBIGq8IBUtGbeEni4Ml6ScXoCDRD8qDQnuInXvXfAvtEvqvjdu0trfWTSDXEnJsoq+5yJNL19jmGcUdRT3FPPN1a0xjIrr19p0bVPlLexoo97vKHc2hCbBm+8kQIvEWK4ZPteFUdRFHXVYgfl3HUQsyCCoPdmsK/ztlNiD+mewpr2SGZeqNqAfbMEoq2ijU/DZzQ0me+375e0lChZ0VBXIGacCJFWTywr8l11Ar/Hhxj2rq5lo3z4yBEa1Oda6c/NQHetOtI/n4pQak27m5raLPxwYjh9nqC2kshNtXE8UmJW3RRp/8auSpethxE9qNAJVonjC29+6uH59I3wzlIsd4nwvN6J93Hn/MrAMQZaXktaYHqO2vxHrePamF/WKxwH35o4DhbzopWdUJlhcYDiniSEUcDSiTLAkRTLzCKo6prBu4Efg0iQbcejWWeK8V/7zmVmqMpFFAUHyqPHaX4AGw4TwVLPk9zqAl3cqAqXO+HU8i5WyWA8eDxuSTTU9V5s0u2hR5NdsZeF9fYeyLsKa+7IxF8/BdLVMo6Q6kRv4sPR7NKpjkPPqe/NMhpQsEllkyOP0+p+jbKJq/goSUFJ5XZ+VYaL1cmwalMKWiXi+IGchvJvtdw1FYwrmSxkIdX/7rsOU2MhK0Z4BvKDq2ttC8GZaK4ON7GhVtJAA4d4PR2rdUcYqXXkoQTZ/hJAHSMj89C56jress8QpNAHpP6ErnyZI0Vu5EYKYstPyDGbSE0YOvR5ZN70bGGXJI310q3NQqgXOnFEJf3TWbsGmH0/5BHL7l+D5ZfSFnDPtw0ZBaUGC689uOZA/QnO5fwjK66leX1pFQOlXhK9oFyaxTfkY16lbARuKSvjZR4aefsKOayo/sIoJ/oVch/ALNskcp+Utl+jlPWpjf03dWCFhN2mx6HSIg+TaN83/mQOUMUT2XVnEzOXHatBTYo1KjJAS1i5rKZCBxXw0SegNyasJlrcFdMU4dMNF01bDbwFaHzIPPmUAZ9ID9loEuQZfqA8qYCZKdtJwW5o3U99MV2vmXSKPEGpb5xWxZ2aBIYIdwxsnOjRyJYRDSpvLPu/qn1mMCySQ8t8Q/9d4keiYs+nGqeVF8r22e3qGuH8svP2Ww5+snnxQbga2qKyo+Imqn+J0eurfEPnV2uGQv6rMvkjEJMNjK5fQnm53SDPUdkUbmodChpMeoCdy1OxKNo/e0t2gu6xa503Um7EdD2QHVfx37N4nBiftJrNjFG95gDZy+irojlty6nvqqyMP9qz9/iO/1OXVzqIV6KO73KlsDgWn4c7YHKbz2XXW59rfZnjbzOq+IESAvy+WlCg1PlmYPlJjlhKt+NHqxbXvp3vcbijlDGjDp0kBWWSyuUgqsrHUm3fR9Hot0F+19CZajPbjrYVACZUGK6vTfF0IGG7y32OqrRo5LkqsgzKVgLg6W+Ue4M80UENmEX+X0EChNJnG97B8F0+6bYV3Ai+Kog4+4gdnXM9x3xMXIdbulfpAGX4D3wYOoAHdFd5I8mHyx2uyyMEJjxDPjvAaxP6Yri5arBPlT+V8t6M97GX81mYKVA+T3ZHRGxndqhPYxAcGObZpSe1DNW//KAFBc1j/1YXrqeFxwiGi1+j9tGQQ5MO0nppiDq9kdepC5BpMmsQWoqscHFme2tXfY1qaZKyN6QOHyZ/FXg4Vu/c1r7+XxxbzCBQvObQRW+OF67G9EKGHDuOzudXy8mvue8CIqkClJtn/Vna4QngOWCBVfaTQaZ2phORnrJGJGN+vtywdaB4ThINOgX+SSYVu0NUQDWkchO/BM4plYMyzJA1VwjYsanpB0D8cRPh3x0kPSqsnn6CR0kb3OYNh9ywO9DRgvHVxX61sERMdKNFcL953/Qeh/bgqVb/zX1bxK8fv85tyylXTcrFUOKvH2/PonJVPXQa7qAu0RTEmtRWMCWm2Uq1K/VgBbd5ADoIqQc1FtQKdC6iMiTjofIXc5r7FOH8T5i5phCYoCe3+QeLsGnBVS/1vNrSh5Ydb6SiOh4Cg/zdnplLy/VgHMRu4L3pJSROWlpbfZg/fJ3MvAPgF6Ix2hzT0i0NR6NeW0mVniqN5BrBfthv/+hcx4aoV2Gx5L8ygmzIxdmLsSznkATrfRWSXygsd6CkJf9af5kEdx7A6lk9Qo+1Hrbq+6XhD4GyUS0e/I+SxOc6hlBrX2SYD2AYVZbx6qW7LIa8A2j0nmZBhn/8aDfXwMVNCPxAiwxNFGIYE29eOnd58+1hkqlF4eyYZNqRao/DWH7OCme/h/J++fupDzDFtEe/LqTtQALAxJBXhw01RjejSXrzqmIgOthzZbMeHYzRL9a8gUMdGMlrNtyC6y762Z62XDOBKcAQ+ozr7E8PZ5IfA2MJ6pnrA/hwymCmfMu8YyThp5koSkeJOwI+XMbt59enRTO3q4uao59gUI5r7XTMa+BgQvYYR952NF3Y8EG1DGN3E7ceu2Y2X53AUE6QaRL9Hwk1WiefQ+sPQdieV47+ja9i63qinvWYV+//NxCqzDpPgv9JTo22jg0FfHSqV3XNfAlKObfszhIKjZ/Gee0IonU1el8nWvV1kIwr0E2MacIXqC/wxEINC6WknBPEtKA0i/gjX0N211pnSOS0cKoQ2GhOXJLWD9TBoxJkk1Vobjnac/1V6u48QngYMeHJIhcIsam3WFMA0gAdntYsNyyrnfhiJu46ARTzRezeZLJjG+ogmY/reI2fKOfHCgFJ6ePROGpWK2p7UWLCNJ1dUtUPDL9IM7iVEfrj/mikuqQzdEGTp8bCw/7QBahFTa2tnkA28xMa4V1ZmBWSgibrvNKfpp0e/ulvhCTuVCUryi79ZxOILRNhkAwcBJ2PSvzfXQxUICFPMNOzYDlbQN8L2x70XfzGTESDKxWgzoaWD1G+DEqUz982bI391PQHaZ3wJpgMCFC84f1tsLQzYI5Xn9l5f3T254ZvnpIV2G4cM/T6/y/p3Ge6NXr+iv72VVvXQbXkvX+Og/8EcJ47iwK6FWYpnU9kRNSWbXovyLycZXOmal8ppmAazLV+IpmsuXDWg0OT4vjEmTUlhQvlBAQvjdMSmCSiprGt6YY5XJe92BsC1GsZU1FsE8AUak0JLKVJy0PlW+JP9YgwoVpy9bXCtrmicqdIsDD54L2m09mjtufi60IPsFuzkYx467ZsCBQwOlN3jgM3kSATO5r1hgqg0XaZVJAuw6eDxwT934DUovywbRIYve562nlNIlj8HlUCCTN0XPzHqTGmwjoqg6BC+QTGAAlw1pXFQADnP5VJNtUFWHT0yYE/PTFSa58tLFL7zukQD+NzaOzYs7KSZ6swWshAEDMuUHjXta2+m+/53/vkWi5HQRX+vANMW4B3DVEP/cIqfT4oYx1iP/st9dJ4ZrTRuFQ6KgXme2A4UPJ5kQ0UMQAP3Yre+sSkB+NmBIaLZsEHmfPWWhkEG38LtKIAI268oqBkS2WucCxpPKopUeuJFWg+z3Rgb0KtLFzahhTHhkawbnM+UlWcHsTxR9Gv2RZLmNYYB3N6fuV5GHN8fVaXUvj7p0/I6inRuOAptjLFnTkxDZfZnQSuQaYEwilxv6tbyouBlxA8umBXw3w7KnZ/TZzGF2rsJw9+6VUNd1b85z6rkVQmfYUZu/U9L8dlXmD8oRA9EnpL7Jz3P/frupQY3Z2ESyjV9mhqu5ya2KSWtq+uOdsXps6Vmt9By8pn7sdLmMsige+Smb/b83XdXY2YWCe4Mv4fZuWqNGejHrT7s3os9c1RcWNwvWBjqF0BSRWfZVseJ1HIJjSWcZKZBxueyKQYqY185JhwDO/5mWdapjhTy7a7OiINquhP6/u/6+4XKUfC1esUb9OnGVddjFMsTVA9ekBbJEnETNMWBKt2pkXbrP83fLk8KCuMpJLg2aSvCAn1WuMABRqHmxEIlVWsZktS2qcQvz7wL5r925qp39PaKjIONauARy1Bgi1sRq5a8gz/D9AIQ6/08Hn3HfhrDo5hCighN28O8+0ELL3ubzBP3pccYi7TW+/zNzSQDyDlgZidqlyjgrpFAZHl2UTTW1xLaqMODMe6PqoNlnC7142Yq+M3O/VUnQbMCFz9Q80zkfz5SPRXeWlvpqP17z3CmuumLQlXqYFVMhab3nmC+M0kpUIk4vZoxgqjuCmsxXAPyDKBvdZBPAOrbbExUVD8VfR7vp6NM66ZqvXI6Ha2o7t3nTJzVwzMbXqLORCP+UinknUvNUeSXsUKXUpbgcNALiO71+jxzQgO3WckV1Gpr36nVcwdXc/GmC+tVo+cuZnxHXZT94nCXF+vZdLRcGFMeCUnq60pCpgxYE1pQhYJFssCb1QGjsdXl5LPkFEnBpoWoa/6+GD+8pxcwZ1rvthnuw90iyhbkFgqmcFD3SzJMYG/SxzSB8WH7NQQKCN8RKja3wJGWJIKa2s+mG2D5UleDJ3+Sd99/xYO2apLPI3tYvDW74EBSj4s6arWvCsJgePsFWvdR/udRX8k01PTTFNBqlzx+Gm/54thKkiZO1qbb+IEboD2gyWo18Ht+Rziud92X1vuJyUk89FDlXZrC63PjpXk+LUFslDP7ksuff3Xk4fhe+LQg8wM3NCVl2Do6Ur3U6S/0Ty86PCx7vyMeo3yabTm2YmE1AYyn32ylmMOOrA4VHxuf/xCdkPdSEPT6V7x6tdjrWgWAO72X9/RFz5IKOFNGVjjWPWFI5n1wN2dOH/6NXxizRzniVUa3f7bvJcV1oxrzgtmOIjWSZFvBjKMULGvu6KcOc5oB0z6ELPeeUOT5vlgyNBmAbYvKPVVrbLSioXskGTMoB33c5j9C1GCvlvI801dAKq3ACeuY7rA19ZURvWwHFkdE5mibvHBAU5zA180iLBjUVumEZ7ZZqHmZMRg/L9ICOnka0hoPjcRx7fLJMAF7cUFBv2cfHwfEVBlyoseIw2FxjnZKnTOyk5JGRGYGtBrixF33EH7pH6G39YpIH03I4R/xgOq4vAsSy/OOdnmQ9YD+2r5OP4x/8CTrEcjenU67S25mxMKqnFKF36Yqkiyml7ZMfU0U5akD+TRPZ29RY2GDdU6bOWh+tV6Db+Bqy2uPX9PXp3VWFVqmAHNEhZXSajug6c5iWvFN2eJtdpe6ofZ9reHJMzG8hSrjqetCYOX8MjT2tKVJqpdsXye80AdQ+7oz0ERpAcSOtLDcwLsjGxGDqPwLetlNo1J6JrbQ/a74bdinWtzxcpbAuG24k0tj9T+f3exctDpYsarsdA4KeMGkA03E8O4uNXZgdWxptGfiANntAwCP1+kCW5o1KV5pnkbnbWtijuKMUXFetwash19JXIEHy9sZATtYo3LrNLyTjxY/CzqlUs4mbyzpwo0wwx9UkAs1cVMxHeAuMayHDakVix/TSOhgrIfOulHTEsnUJcdy9AUcONsZPSsgYrDyE74fdUHJGiFYn+MToQ2f87gcRAYdxqx+ucD7FRC7ffE3rF92LrbvxtjWWwvR2JTj3X56L2hCOOxtq1qpx1xugNBU9U/Yg5GowKJjt2XqX+CM0hx2GCoB/GfjzPuXTP9RkEokZTnaITqPJCWmusFCNkkiQYbYnqq5VV4zSIG6wv7GZvdvHCQtlWa1zi3k72f8p4+GPdmLbMLM3UOILkNRZ9/wC9JJlHW0gQmd8VGqgn2ETvm0A7QWtoL2e6on4zQsHvixbF0nhRDdRBj7qiNymMTEf46OUAb236vy9Blnxw6ZJ5b9Re3AQhB0IhymMK6/6a71wiAoHDklOYO4GF1wniWTJmu+Y2sdaxTJvlYkplJvBco6QNFq24jP22XXVPpQuxGiqjZu/0NmTUwNVpyWN9VjmsSHXqr9VKlU5ie4+0mhhIfVoq3oh8fXYW0x4WJ7bQgYj18jUXKz5ZQlanrA8h7MChWEZnvtiEBp/NOiCmHTxN+tS9F7586VRSWU2RHaOqFI/C8XzJfp1d0Q1qCswrfz5/kJcWngE0XFSow5V5fSVtG0eeMvQ20U45QP18sHRJ74aAwnxqJQKNuWT1KbsKgVd3mgowOT2oZZl15VIA7mRqUBtw+KncrRwTe0uycNji67Oub5m2z7ZnxiY7rmqC6zoX5YqS6NPgM7BaVCUblDg+o8nznFvf50+0sLZVFf7ekFWPGhKFgd4auNm7orHbEReZVA5vzPdFH84v7tIJqzzSjWB1b7R1kd1tndGJdCoRhIiIs2sCem7WBbEhKzC3AwFM1Clo89cCHdAY4uNUmqrz95yrmEK7kyjLm3Er1ojPF7YjOYBBMrLPGQylZADr6wjkCY8vbqJZ/JAjrlytXw636v9Ub86QzYaoy12+bCP8Pv18kwjDZIGek8aKUnD8cUSk/u5H8UgTF0neBv8j3fc28ZJcXAZldlpUs0ZqEZoGY2EKv7ZlLyFMjOAhjb7Kv0/khdOnPkqgwPDVNxy3VdZR5R6CyiYcSKSAec8Djg0+jjM82OumwA0QbGMw8asWaitJQca1vEynl4kdSAbqu089NUbxJgQ6vrvk4KgZg99wnZbaqqvuW87bKlQNi9hb35srQh/cuQi9SLbP5ZUp8Lt8qIFHm2yIt+jyDlmLZr4oHQ/mXGdCrpQ+Esk3RrDsR94y/SMdc1RIAS3AaR/nmo3CaujD1VUth44JOFoCjOTLIALxW+lXSm2HCKsvOR4Myv59TijbeI+vpCFTV153kP82YSFUSvg43V59KFYxIpmf5yFLWwxj3Egp7QV1dRbaxPJHC2O4Crdvr42gSOHRuufAyjh2OAnX8QKP4NC7w4Uj+3bp/97IRYyjCL27ZUTPcwQAHsB7HkeZAQjTMVQW8Wn4qLtVa0Wh7ezn7XrnWYHAuBG2FBiM6BrKpCTDxKxfn6LRB+LJtrJn0jGC4S1Obq8aQ/Kk4AMLDmi33AXNegeFutKzCvs/oWBUcKMORMStPtweBoYNwVtLQlnhSbtU4+iM+wYIEDKf4QWN/Ij0yw9bAngLis29xO0IEPPy/WdN+8LKKPfCiPYPLotpPVAMVZry3azPPKSc3bx8yjLkAgFRrcPEadURQA4LN0l00+pUVK0yHie5+q9X7kA6ElzTi1BpByGcTOKUlXmoCgZmzMuG8zIJLka0Jw/jWbR7/lw68Scao8gM1PuUNWoJAZ+YGUj+yP8KqYujJX9vqhiyCUwXHfP3mrROoEWxAg0ixxoQQqzOiLWwgOXVb0VS6iOfnH4/kBuAjPsJrtUd5JK2JLe+9GkU5yfjjQW7DtjWBMwE2oX4ilyiyTjFMqOY7s65o85HtwkhCUWgJG5g4KhfR19f/NpQ2SbQtI1ziSJdFXpMnjlCx4YVmtxOLBWxbycEooX/beGHRglWLHQxp3DExRu4dbAh5rtqz4B93/I66ihHAN6bz+PYwjaRhDpv5Z3PErrBY0oOXoOIhDB2v9SQzykzAZU2nZ+j+fgYPM285YslLDnaN9XuQ864/0+sJDT1ioCtSf7Zw5F6ODScCFyae2HxERJt7DktLd4nStCreDF0r7CHHZ79cmREjpA2Nm3ZIvXGwnp+Aah2tMMWwxsX2WiyFKOTJJuE1dnJMaedXon0rcjm1DGf6DH7l6jQPqL61BCOx0xDfo+GwIH0LVC2WzYOIkBy17bFyM7JK28vyrCTgm6P5mnPdm72+rfmAUM0KxRADQovQXspu5Xm75Yb24PQBs8JB3BOwWPWEr264lHecEJtegaWv+9HshlkE4zQE2Qd0U5SG3K9Oe3l2A1nIRaMG9O0DpHsg9VOPpA4beqx/wgUiMDAXhOkmA02slYX+2e/Sf7vkYw1GxFyFigG03GEKTBaZA8/HXnQRNXFq/LgjEn4eFWae+emIVsYFjmX0bLpIJcBEHsf+o/OZIAKAKKsf8LxXhrEqrJon1DeNreYDAY/jvDVemu60jImNFxYQdqIk076/Dt1HiFIGfWPyRKQDotEhXZOGm/RssincyRmNsdI/NE/somRndKRjqulW4BTl+PMWIPlYvD+D8SXsEbYuHFFEmhABeBL+syvBUR+kXakXcFgNJavw9HI4GMu3VNf9dEh9ZBU1cRN90VYsRadjNhaOgrS31jOiDAAAAA" /></p>
<section id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/AndreaZoccatelli/light_permanova
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>adversarial-robustness-toolbox
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fatal: destination path &#39;light_permanova&#39; already exists and is not an empty directory.
Requirement already satisfied: adversarial-robustness-toolbox in /usr/local/lib/python3.10/dist-packages (1.18.1)
Requirement already satisfied: numpy&gt;=1.18.0 in /usr/local/lib/python3.10/dist-packages (from adversarial-robustness-toolbox) (1.26.4)
Requirement already satisfied: scipy&gt;=1.4.1 in /usr/local/lib/python3.10/dist-packages (from adversarial-robustness-toolbox) (1.13.1)
Requirement already satisfied: scikit-learn&gt;=0.22.2 in /usr/local/lib/python3.10/dist-packages (from adversarial-robustness-toolbox) (1.3.2)
Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from adversarial-robustness-toolbox) (1.16.0)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from adversarial-robustness-toolbox) (71.0.4)
Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from adversarial-robustness-toolbox) (4.66.5)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=0.22.2-&gt;adversarial-robustness-toolbox) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn&gt;=0.22.2-&gt;adversarial-robustness-toolbox) (3.5.0)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;/content/light_permanova/permanova/permanova_torch&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">lightpermanova</span> <span class="kn">import</span> <span class="n">LightPERMANOVA</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="kn">import</span> <span class="n">resnet18</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">import</span> <span class="nn">torch.utils.data</span> <span class="k">as</span> <span class="nn">data</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">art.estimators.classification</span> <span class="kn">import</span> <span class="n">PyTorchClassifier</span>
<span class="kn">from</span> <span class="nn">art.attacks.evasion</span> <span class="kn">import</span> <span class="n">FastGradientMethod</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ResNetFashionMnist</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">resnet18</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span>
            <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
    <span class="n">test_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">test_images</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">test_loader</span><span class="p">))</span>

    <span class="n">test_images</span> <span class="o">=</span> <span class="n">test_images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">test_images</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</pre></div>
</div>
</div>
</section>
<section id="Dataset">
<h2>Dataset<a class="headerlink" href="#Dataset" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>

<span class="n">training_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">test_data_tshirt</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz to data/FashionMNIST/raw/train-images-idx3-ubyte.gz
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|| 26421880/26421880 [00:00&lt;00:00, 32888532.66it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Extracting data/FashionMNIST/raw/train-images-idx3-ubyte.gz to data/FashionMNIST/raw

Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw/train-labels-idx1-ubyte.gz
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|| 29515/29515 [00:00&lt;00:00, 9146278.73it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Extracting data/FashionMNIST/raw/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw

Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

100%|| 4422102/4422102 [00:00&lt;00:00, 10430722.81it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Extracting data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw

Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|| 5148/5148 [00:00&lt;00:00, 25859014.36it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Extracting data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no_tshirt_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">training_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">tshirt_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">training_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">training_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">training_data</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="n">no_tshirt_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">training_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">training_data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">no_tshirt_train</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>

<span class="n">no_tshirt_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">tshirt_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">test_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="n">no_tshirt_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">no_tshirt_test</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>

<span class="n">training_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">targets</span> <span class="o">-=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data_tshirt</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">test_data_tshirt</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="n">tshirt_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">test_data_tshirt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">test_data_tshirt</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">tshirt_test</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</section>
<section id="Model-Training-+-Save">
<h2>Model Training + Save<a class="headerlink" href="#Model-Training-+-Save" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ResNetFashionMnist</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>

<span class="c1"># Training loop</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">)):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">X_batch</span><span class="p">,</span> <span class="n">y_batch</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
        <span class="n">X_batch</span><span class="p">,</span> <span class="n">y_batch</span> <span class="o">=</span> <span class="n">X_batch</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">y_batch</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_batch</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Epoch [</span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">n_epochs</span><span class="si">}</span><span class="s2">], Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s2">&quot;/content/model_state.pth&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Load-Trained-Model">
<h2>Load Trained Model<a class="headerlink" href="#Load-Trained-Model" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert test data to TensorDataset</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ResNetFashionMnist</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;/content/model_state.pth&quot;</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-12-7514c2467b43&gt;:3: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don&#39;t have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(&#34;/content/model_state.pth&#34;, map_location=device))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;All keys matched successfully&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">predicted_classes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predicted_classes</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">test_data</span><span class="o">.</span><span class="n">targets</span><span class="p">)</span>
    <span class="o">/</span> <span class="n">test_data</span><span class="o">.</span><span class="n">targets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy Score: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy Score: 0.93256
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove the output layer to obtain the embeddings</span>
<span class="n">embedder</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">children</span><span class="p">())[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">embedder</span> <span class="o">=</span> <span class="n">embedder</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Embeddings of training dataset</span>
<span class="n">train_emb</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">embedder</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">train_emb</span> <span class="o">=</span> <span class="n">train_emb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">train_emb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Embeddings of test dataset</span>
<span class="n">test_emb</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">embedder</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">test_emb</span> <span class="o">=</span> <span class="n">test_emb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">test_emb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Embeddings of t-shirts test dataset</span>
<span class="n">tshirt_emb</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">test_data_tshirt</span><span class="p">,</span> <span class="n">embedder</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">tshirt_emb</span> <span class="o">=</span> <span class="n">tshirt_emb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">tshirt_emb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Comparison-with-PERMANOVA">
<h2>Comparison with PERMANOVA<a class="headerlink" href="#Comparison-with-PERMANOVA" title="Link to this heading">#</a></h2>
<p>Comparison between train set and test set embeddings: the null hypothesis (samples are equal) is not rejected. PERMANOVA confirms that the images come from the same population.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permanova</span> <span class="o">=</span> <span class="n">LightPERMANOVA</span><span class="p">(</span><span class="n">train_emb</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="n">permanova</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">test_emb</span><span class="p">,</span> <span class="n">tot_permutations</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">pvalue</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
  0%|          | 2/1000 [00:00&lt;00:55, 17.84it/s]/usr/local/lib/python3.10/dist-packages/torch/storage.py:414: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don&#39;t have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(io.BytesIO(b))
100%|| 1000/1000 [23:48&lt;00:00,  1.43s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p-value: 0.999
</pre></div></div>
</div>
<p>Comparison between train/test set and t-shirts test set embeddings: the null hypothesis is rejected. The test confirms that embeddings produced by the model on an unseen category do not come from the original population.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permanova</span> <span class="o">=</span> <span class="n">LightPERMANOVA</span><span class="p">(</span><span class="n">test_emb</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="n">permanova</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">tshirt_emb</span><span class="p">,</span> <span class="n">tot_permutations</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">pvalue</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|| 1000/1000 [03:34&lt;00:00,  4.65it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p-value: 0.03896
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permanova</span> <span class="o">=</span> <span class="n">LightPERMANOVA</span><span class="p">(</span><span class="n">train_emb</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="n">permanova</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">tshirt_emb</span><span class="p">,</span> <span class="n">tot_permutations</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">pvalue</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/content/light_permanova/permanova/permanova_torch/lightpermanova.py:40: UserWarning: New sample is more than 10 times smaller than original sample, consider subsampling original sample for a more reliable test.
  warnings.warn(
100%|| 1000/1000 [21:15&lt;00:00,  1.28s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p-value: 0.04595
</pre></div></div>
</div>
</section>
<section id="Adversarial-Attack---Training">
<h2>Adversarial Attack - Training<a class="headerlink" href="#Adversarial-Attack---Training" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://adversarial-robustness-toolbox.org/">Here</a> the link to the adversarial robustness toolbox, a Linux Foundation project.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">PyTorchClassifier</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
    <span class="n">nb_classes</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
    <span class="n">device_type</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">training_data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fgsm_attack</span> <span class="o">=</span> <span class="n">FastGradientMethod</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">classifier</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">x_train_adv</span> <span class="o">=</span> <span class="n">fgsm_attack</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time for attack (in seconds): </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time for attack (in seconds): 30.333730936050415
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/content/x_train_adv.npy&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">x_train_adv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Adversarial-Attack---Load-adv.-dataset">
<h2>Adversarial Attack - Load adv. dataset<a class="headerlink" href="#Adversarial-Attack---Load-adv.-dataset" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/content/x_train_adv.npy&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">x_train_adv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions_train</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">training_data</span><span class="o">.</span><span class="n">targets</span><span class="p">)</span>
<span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_data</span><span class="o">.</span><span class="n">targets</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy score on train set: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy score on train set: 0.9957
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions_adv</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train_adv</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_adv</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">training_data</span><span class="o">.</span><span class="n">targets</span><span class="p">)</span>
<span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_data</span><span class="o">.</span><span class="n">targets</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy score on adv. attacked train set: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy score on adv. attacked train set: 0.32561
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original Image&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_train_adv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Adversarial Image&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/experiments_docs_fashion_mnist_test_38_0.png" src="../_images/experiments_docs_fashion_mnist_test_38_0.png" />
</div>
</div>
</section>
<section id="id1">
<h2>Comparison with PERMANOVA<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>p-value is less than 0.05: null is rejected. The test correctly detects that the corrupted images do not come from the original population.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">train_adv_emb</span> <span class="o">=</span> <span class="n">embedder</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">x_train_adv</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">))</span>

<span class="n">train_adv_emb</span> <span class="o">=</span> <span class="n">train_adv_emb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">train_adv_emb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permanova</span> <span class="o">=</span> <span class="n">LightPERMANOVA</span><span class="p">(</span><span class="n">train_emb</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="n">permanova</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">train_adv_emb</span><span class="p">,</span> <span class="n">tot_permutations</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">pvalue</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|| 1000/1000 [41:29&lt;00:00,  2.49s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p-value: 0.001
</pre></div></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="test_tabular_numpy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PERMANOVA test on tabular data</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Dataset">Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Model-Training-+-Save">Model Training + Save</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Load-Trained-Model">Load Trained Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Comparison-with-PERMANOVA">Comparison with PERMANOVA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Adversarial-Attack---Training">Adversarial Attack - Training</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Adversarial-Attack---Load-adv.-dataset">Adversarial Attack - Load adv. dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Comparison with PERMANOVA</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andrea Zoccatelli
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024, Andrea Zoccatelli.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>